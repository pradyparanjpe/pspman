#!/usr/bin/env bash
# -*- coding:utf-8; mode:shell-script -*-
#
# Copyright 2020 Pradyumna Paranjape
# This file is part of pspman.
#
# pspman is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# pspman is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with pspman.  If not, see <https://www.gnu.org/licenses/>.
#


prefix="${HOME}"
while test $# -gt 0; do
    case $1 in
    --prefix)
        shift
        prefix=$1
        shift
    ;;
    --prefix=*)
        prefix=$(echo "${1}" | cut -d "=" -f 2)
        shift
    ;;
    -h|--help)
        echo "usage: ./configure [--prefix=PREFIX]"
		exit 1
    ;;
    *)
        echo "usage: ./configure [--prefix=PREFIX]"
        exit 1
    ;;
    esac
done

touch Makefile
printf "" > Makefile
echo "prefix=${prefix}" >> Makefile
prefix=
echo "all:" >> Makefile
echo "	@cp pspman/gitman \$(prefix)/bin" >> Makefile
echo "	@mkdir -p ${HOME}/.local/share/man/man1" >> Makefile
echo "	@cp pspman.1 ${HOME}/.local/share/man/man1/" >> Makefile
echo "clean:" >> Makefile
echo "	rm \$(prefix)/bin/gitman" >> Makefile
echo "	rm ${HOME}/.local/share/man/man1/pspman.1" >> Makefile
echo "install:" >> Makefile
echo "	@true" >> Makefile
